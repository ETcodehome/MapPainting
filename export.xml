<?xml version="1.0" encoding="UTF-8"?>
<project name="MapPainting" default="jar">
	<!-- Environments, do not modify! -->
	<property name="dir.src" value="src"/>
	<property name="dir.doc" value="doc"/>
	<property name="dir.bin" value="bin"/>
	<property name="dir.api" value="api"/>
	<property name="dir.dep" value="dep"/>
	<property name="dir.temp" value="temp"/>
	
	<!-- Modify when bukkit API changes -->
	<property file="build.properties"/>
	
	<!-- Modify when Map Painting API include paths changes -->
	<fileset id="exported" dir="${dir.src}/net/aegistudio/mpp" defaultexcludes="yes">
		<include name="export/**"/>
		<include name="algo/*Generator.java"/>
		<include name="algo/package-info.java"/>
		<include name="algo/Paintable.java"/>
		<include name="Interaction.java"/>
	</fileset>
	
	<!-- Do not modify the following code -->
	<target name="init">
		<mkdir dir="${dir.doc}"/>
		<mkdir dir="${dir.api}"/>
	</target>
	
	<target name="doc" depends="init">
		<javadoc destdir="${dir.doc}">
			<fileset refid="exported"/>
		</javadoc>
	</target>
	
	<target name="api" depends="init">
		<mkdir dir="${dir.temp}"/>
		<copy todir="${dir.temp}/net/aegistudio/mpp">
			<fileset refid="exported"/>
		</copy>
		<javac srcdir="${dir.temp}" destdir="${dir.api}" classpath="${dir.bin}:${dir.dep}/bukkit.jar"/>
		<delete dir="${dir.temp}"/>
	</target>
	
	<target name="jar" depends="doc,api">
		<mkdir dir="${dir.temp}"/>
		<copydir src="${dir.doc}" dest="${dir.temp}/doc"/>
		<copydir src="${dir.api}" dest="${dir.temp}"/>
		<jar basedir="${dir.temp}" destfile="mappainting-${version}-api.jar"/>
		<delete dir="${dir.temp}"/>
	</target>
	
	<target name="clean" depends="doc,api">
		<delete dir="${dir.doc}"/>
		<delete dir="${dir.api}"/>
	</target>
</project>